import{a as g,t as S,c as j}from"../chunks/disclose-version.D2fD36qC.js";import"../chunks/legacy.DDnI4mLS.js";import{h as L,b as U,_ as M,$ as v,a0 as O,a1 as P,s as R,a2 as _,a3 as h,a4 as k,g as x,a7 as A}from"../chunks/runtime.BAIukHDA.js";import{i as I}from"../chunks/if.B3BZkMBm.js";import{a as p,b as y,u as z,c as C,s as D}from"../chunks/state.svelte.Dmqpf5cX.js";import{i as T}from"../chunks/lifecycle.D45BoICY.js";import{r as W}from"../chunks/misc.Ivegw3xs.js";import{o as q}from"../chunks/index-client.D2v7NhQZ.js";import{g as B}from"../chunks/entry.BFFjY6Nd.js";function E(d,r,l,i,f){var o;L&&U();var a=(o=r.$$slots)==null?void 0:o[l],s=!1;a===!0&&(a=r.children,s=!0),a===void 0||a(d,s?()=>i:i)}const F="always",G=!1,H=!0,ta=Object.freeze(Object.defineProperty({__proto__:null,prerender:H,ssr:G,trailingSlash:F},Symbol.toStringTag,{value:"Module"}));var e=W(()=>z),J=S('<nav><ul class="svelte-1sf1bgw"><li class="svelte-1sf1bgw"><a>Log In With Alby</a></li></ul></nav> <!>',1);function ra(d,r){M(r,!1);let l=A("");q(async()=>{R(l,`https://getalby.com/oauth?client_id=${C}&response_type=code&redirect_uri=${y}&scope=account:read%20balance:read%20payments:send%20invoices:read`),await i(),console.log("DOM is fully loaded")});async function i(){console.log(p),e(e().address="");const n=new URL(window.location.href).searchParams.get("code");if(n)try{const u=await(await fetch(`${p}/alby/auth?code=${n}&redirect_uri=${y}`,{credentials:"include"})).json();e(e().address=u.lightning_address);const m=new URL(window.location);m.searchParams.delete("code"),B(m.pathname+m.search,{replaceState:!0})}catch(t){console.error(t)}else try{const u=await(await fetch(`${p}/alby/refresh`,{credentials:"include"})).json();e(e().address=u.lightning_address)}catch{}}T();var f=J(),a=v(f),s=_(a),o=_(s),b=_(o);h(o),h(s),h(a);var w=k(a,2);{var $=c=>{var n=j(),t=v(n);E(t,r,"default",{}),g(c,n)};I(w,c=>{e().address&&c($)})}O(()=>D(b,"href",x(l))),g(d,f),P()}export{ra as component,ta as universal};
