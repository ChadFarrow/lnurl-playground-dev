import{c as K,a as k,t as P}from"../chunks/disclose-version.D2fD36qC.js";import"../chunks/legacy.DDnI4mLS.js";import{_ as Q,$ as V,a1 as W,s as r,a7 as _,a4 as e,a2 as a,a3 as o,a8 as T,a0 as X,g as s,a9 as Z}from"../chunks/runtime.BAIukHDA.js";import{e as $,s as G}from"../chunks/render.B39leecd.js";import{i as ee}from"../chunks/if.B3BZkMBm.js";import{e as se,i as te}from"../chunks/each.CWQedB2T.js";import{a as l,u as w,r as j,s as ae}from"../chunks/state.svelte.BFtl8ovC.js";import{b as D}from"../chunks/input.BH0JO5kO.js";import{i as oe}from"../chunks/lifecycle.D45BoICY.js";import{o as ne}from"../chunks/index-client.D2v7NhQZ.js";var ie=P('<div class="svelte-hkbmpq"><input type="text" class="svelte-hkbmpq"></div>'),re=P(`<main class="svelte-hkbmpq"><a href="/">Back</a> <h1 class="svelte-hkbmpq"> </h1> <div class="svelte-hkbmpq"><button class="save-settings svelte-hkbmpq">Save Settings</button></div> <div class="auth-token-container svelte-hkbmpq"><label for="alby-access-token">Alby Access Token</label> <div class="svelte-hkbmpq"><input type="password" id="alby-access-token" placeholder="If you see saved, your token is saved. It's not shown here because it's a secret" class="svelte-hkbmpq"> <span class="svelte-hkbmpq"> </span></div></div> <div class="guids-header svelte-hkbmpq"><h3 class="svelte-hkbmpq">Approved Podcast GUIDs</h3> <button class="svelte-hkbmpq">Add GUID</button></div> <!> <h2>Instructions</h2> <h4>This would go in your feed. If you're using your own server, change the
      server route accordingly.</h4> <pre class="svelte-hkbmpq">
      <code class="svelte-hkbmpq"></code>
</pre> <p>If you're using Alby Hub, I recommend setting up a <a href="https://guides.getalby.com/user-guide/alby-account-and-browser-extension/alby-hub/app-store/subaccounts-friends-and-family">friends and family account</a> for this. <br> I picked the one called 'Subaccount with Lightning Address' <br> I'm not saying you can't trust me, but if it was me, I'd rather have
      this linked to an account that only has enough sats in it that I'm willing
      to lose.</p> <p>Your <a href="https://getalby.com/developer/access_tokens/new">Alby Access Token</a> is retrieved from the Developer Portal section when you log into <a href="https://getalby.com">getalby.com</a> <br>You need to select 'invoices:read' and 'payments:send'</p> <p>You also need to add the feed guids for each of your podcasts. That's to
      prevent someone using your address in their feed. If they do, and the guid
      isn't in your approved list, you'll still get the sats, but The Split Box
      won't send them out to the splits.</p></main>`);function ge(R,Y){Q(Y,!1);let c=_(""),p=_(!1),t=_([""]),B=`${l}/invoice?address=${w.address}`,C=`${l}/webhook-sync`;ne(O);async function O(){try{const n=await(await fetch(`${l}/fetch-settings`,{credentials:"include"})).json();console.log(n),r(p,n.albyAccessToken),r(t,n.approvedGuids)}catch{}}async function U(){console.log("Reset password for:",address);const i={albyAccessToken:s(c),approvedGuids:s(t)};(await(await fetch(l+"/save-settings",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json()).status==="saved"&&(r(p,!0),alert("Setting Saved"))}oe();var q=K(),H=V(q);{var J=i=>{var n=re(),d=e(a(n),2),L=a(d,!0);o(d);var v=e(d,2),M=a(v);o(v);var u=e(v,2),I=e(a(u),2),h=a(I);j(h);var S=e(h,2),N=a(S,!0);o(S),o(I),o(u);var m=e(u,2),z=e(a(m),2);o(m);var x=e(m,2);se(x,1,()=>s(t),te,(b,de,f)=>{var y=ie(),g=a(y);j(g),ae(g,"id",`guid=${f}`),o(y),D(g,()=>s(t)[f],F=>(s(t)[f]=F,Z(()=>s(t)))),k(b,y)});var A=e(x,6),E=e(a(A));E.textContent=`
        ${`
<podcast:splitbox
  invoice="${B}" 
  webhook="${C}" 
/>
`??""}
`,T(),o(A),T(6),o(n),X(()=>{G(L,w.address),G(N,s(p)?"saved":"")}),$("click",M,U),D(h,()=>s(c),b=>r(c,b)),$("click",z,()=>{s(t).unshift(""),r(t,s(t))}),k(i,n)};ee(H,i=>{w.address&&i(J)})}k(R,q),W()}export{ge as component};
